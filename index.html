<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>3D Printing Service</title>

<script src="https://cdn.tailwindcss.com"></script>
<script src="https://www.paypal.com/sdk/js?client-id=AWlxRpEWuzvjdHyQ__cKpDgK7pj-qfWo8qGO9BkOlUq_TpiRoChpAdRWsuQp3TqDdH6R3iuql3LBWO_u&currency=GBP"></script>

<style>
  body {
    background: radial-gradient(circle at center, #1a1a1a 0%, #000 70%);
    color: #ffffff;
    font-family: Inter, system-ui, sans-serif;
  }

  .glass {
    background: rgba(255,255,255,0.05);
    backdrop-filter: blur(14px);
    border: 1px solid rgba(255,255,255,0.12);
    border-radius: 1.5rem;
  }

  .neon-orange {
    box-shadow:
      0 0 12px rgba(255,140,0,0.8),
      0 0 35px rgba(255,140,0,0.5);
  }

  .upload-box {
    border: 2px dashed rgba(255,140,0,0.6);
    border-radius: 1.5rem;
    padding: 2rem;
    text-align: center;
    transition: 0.3s ease;
  }

  .upload-box:hover {
    box-shadow:
      0 0 20px rgba(255,140,0,0.8),
      0 0 45px rgba(255,140,0,0.5);
  }

  input, textarea, select {
    background: rgba(255,255,255,0.06);
    border: 1px solid rgba(255,255,255,0.15);
    border-radius: 1rem;
    padding: 0.75rem;
    color: white;
    outline: none;
  }

  input::placeholder, textarea::placeholder {
    color: rgba(255,255,255,0.6);
  }
</style>
</head>

<body class="min-h-screen flex justify-center p-6">

<div class="max-w-3xl w-full glass p-8 space-y-8">

<header class="text-center space-y-4">
  <img src="logo.png" class="w-44 mx-auto">
  <h1 class="text-4xl font-extrabold text-orange-400">Professional 3D Printing</h1>
  <p class="text-gray-400">Fast, precise, and affordable custom prints</p>
</header>

<div class="glass p-4 text-center">
  <p class="text-gray-400">Pricing</p>
  <p class="font-semibold">£1 / hour · £0.01 / gram PLA</p>
  <p class="text-sm text-gray-500">Free shipping over £50</p>
</div>

<section class="space-y-4">
  <h2 class="text-2xl font-bold text-orange-400">Customer Information</h2>
  <input id="customer-name" placeholder="Full name">
  <input id="postcode" placeholder="Postcode">
  <textarea id="address" placeholder="House number, street, city"></textarea>
</section>

<section class="space-y-4">
  <h2 class="text-2xl font-bold text-orange-400">Upload 3D Model</h2>

  <!-- FIXED upload box -->
  <div class="upload-box neon-orange relative">
    <input
      id="model-upload"
      type="file"
      accept=".obj,.3mf,.amf"
      class="absolute inset-0 w-full h-full opacity-0 cursor-pointer"
    >
    <p class="font-bold">Click to upload</p>
    <p class="text-sm text-gray-400">OBJ · 3MF · AMF — Max 8MB</p>
  </div>
</section>

<section class="space-y-4">
  <h2 class="text-2xl font-bold text-orange-400">PLA Colour</h2>
  <select id="pla-color">
    <option>White</option>
    <option>Black</option>
    <option>Red</option>
    <option>Blue</option>
    <option>Green</option>
  </select>
  <p class="text-sm text-gray-400">
    For multi-colour prints, please contact me via Gmail.
  </p>
</section>

<section class="space-y-4">
  <h2 class="text-2xl font-bold text-orange-400">Secure Payment</h2>
  <div id="paypal-button-container"></div>
</section>

<footer class="text-center text-sm text-gray-500 pt-6 border-t border-gray-700">
  © <span id="year"></span> Mulbum3D
</footer>

</div>

<script>
let modelFile = null;
let currentCost = 0;

document.getElementById("year").textContent = new Date().getFullYear();

document.getElementById("model-upload").addEventListener("change", e => {
  const file = e.target.files[0];
  if (!file) return;

  if (!file.name.match(/\.(obj|3mf|amf)$/i)) {
    alert("Only OBJ, 3MF, AMF files allowed");
    e.target.value = "";
    return;
  }

  if (file.size > 8 * 1024 * 1024) {
    alert("Max file size is 8MB");
    e.target.value = "";
    return;
  }

  modelFile = file;
  currentCost = 10; // example base cost
});

paypal.Buttons({
  createOrder: (data, actions) => {
    if (!modelFile) {
      alert("Upload a model first");
      return;
    }
    return actions.order.create({
      purchase_units: [{
        amount: { currency_code: "GBP", value: currentCost.toFixed(2) }
      }]
    });
  },

  onApprove: (data) => {
    const reader = new FileReader();
    reader.onload = () => {
      fetch("/.netlify/functions/logOrder", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          fileName: modelFile.name,
          fileContent: reader.result.split(",")[1],
          name: document.getElementById("customer-name").value,
          postcode: document.getElementById("postcode").value,
          address: document.getElementById("address").value,
          plaColor: document.getElementById("pla-color").value,
          totalCost: currentCost
        })
      }).then(() => alert("Order complete!"));
    };
    reader.readAsDataURL(modelFile);
  }
}).render("#paypal-button-container");
</script>

</body>
</html>
